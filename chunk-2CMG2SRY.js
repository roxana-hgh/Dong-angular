import{a as te}from"./chunk-77HXCA7E.js";import"./chunk-D56ROKHL.js";import{a as re,b as oe}from"./chunk-UDUISN4K.js";import"./chunk-GFYZHMAX.js";import"./chunk-GMA7BCZF.js";import{d as Y,h as Z,r as ee}from"./chunk-SK2G4LIT.js";import{a as ae}from"./chunk-52JZBG57.js";import{$ as S,$a as K,Aa as L,Ba as N,Ca as H,Ea as Q,Fa as W,G as n,Ga as z,Ia as p,Ja as l,K as F,Ka as $,L as j,Q as b,U as P,Y as V,Z as D,Za as q,_ as x,_a as J,aa as C,ba as h,ca as r,da as o,ea as y,fa as T,ga as I,ia as k,ib as U,ka as E,kb as X,la as c,lb as ie,mb as ne,r as f,s as g,sa as A,t as B,ta as G,u as w,ua as O,va as R,wa as m,xa as u,ya as s,za as M}from"./chunk-5JI43ALG.js";var le=["op"],me=()=>["/group-dashboard"],se=a=>({"bg-primary-200/30":a}),de=(a,t)=>({"text-green-600":a,"text-red-600":t});function ce(a,t){if(a&1){let e=k();r(0,"li",35),E("click",function(){let d=f(e).$implicit,_=c(),v=R(33);return _.calculationType=d.value,_.CalctypeChange(),g(v.hide())}),r(1,"div")(2,"span",36),m(3),p(4,"translate"),p(5,"async"),o()()()}if(a&2){let e=t.$implicit,i=c();V(W(7,se,e.value==i.calculationType)),n(3),u(l(5,5,l(4,3,e.label)))}}function ue(a,t){a&1&&(r(0,"div",26),m(1),p(2,"translate"),p(3,"async"),o()),a&2&&(n(),s(" ",l(3,3,l(2,1,"everyone_settled"))," "))}function xe(a,t){if(a&1&&(r(0,"div",27)(1,"div",37)(2,"div",38)(3,"span",39),B(),r(4,"svg",40),y(5,"circle",41)(6,"path",42),o()()(),w(),r(7,"div",9)(8,"span",43),m(9),o(),r(10,"span",44),m(11),p(12,"translate"),p(13,"async"),o()()(),r(14,"div",37)(15,"p",45),m(16),p(17,"number"),o(),r(18,"div",46),B(),r(19,"svg",47),y(20,"path",48),o()()(),w(),r(21,"div",37)(22,"div",49)(23,"span",43),m(24),o(),r(25,"span",44),m(26),p(27,"translate"),p(28,"async"),o()(),r(29,"div",50)(30,"span",51),B(),r(31,"svg",40),y(32,"circle",41)(33,"path",42),o()()()()()),a&2){let e=t.$implicit;n(9),u(e.from),n(2),u(l(13,7,l(12,5,"needs_pay"))),n(5),s(" $",$(17,9,e.amount,"1.2-2")," "),n(8),u(e.to),n(2),u(l(28,14,l(27,12,"will_recice")))}}function _e(a,t){if(a&1&&(T(0),m(1),p(2,"translate"),p(3,"async"),I()),a&2){let e=c().$implicit,i=c();n(),M(" ",l(3,4,l(2,2,"gets")),"",i.formatCurrency(e.netBalance)," ")}}function ye(a,t){if(a&1&&(T(0),m(1),p(2,"translate"),p(3,"async"),I()),a&2){let e=c().$implicit,i=c();n(),M(" ",l(3,4,l(2,2,"owes")),"",i.formatCurrency(e.netBalance)," ")}}function ve(a,t){a&1&&(T(0),m(1),p(2,"translate"),p(3,"async"),I()),a&2&&(n(),s(" ",l(3,3,l(2,1,"settled"))," "))}function fe(a,t){if(a&1&&(r(0,"div",67),m(1),p(2,"translate"),p(3,"async"),r(4,"span",63),m(5),o(),m(6),p(7,"number"),o()),a&2){let e=t.$implicit;n(),s(" ",l(3,5,l(2,3,"pay"))," "),n(4),u(e.to),n(),s(" $",$(7,7,e.amount,"1.2-2")," ")}}function ge(a,t){if(a&1&&(r(0,"div",64)(1,"div",66),m(2),p(3,"translate"),p(4,"async"),o(),C(5,fe,8,10,"div",67,S),o()),a&2){let e=c(3).$implicit,i=c();n(2),s(" ",l(4,3,l(3,1,"payments_to_make"))," "),n(3),h(i.getPayments(e.name))}}function be(a,t){if(a&1&&(r(0,"div",68),m(1),p(2,"translate"),p(3,"async"),r(4,"span",63),m(5),o(),m(6),p(7,"number"),o()),a&2){let e=t.$implicit;n(),s(" ",l(3,5,l(2,3,"from"))," "),n(4),u(e.from),n(),s(" $",$(7,7,e.amount,"1.2-2")," ")}}function Se(a,t){if(a&1&&(r(0,"div")(1,"div",66),m(2),p(3,"translate"),p(4,"async"),o(),C(5,be,8,10,"div",68,S),o()),a&2){let e=c(3).$implicit,i=c();n(2),s(" ",l(4,3,l(3,1,"payments_to_receive"))," "),n(3),h(i.getReceivables(e.name))}}function Ce(a,t){if(a&1&&(r(0,"div",64)(1,"div",65),m(2),p(3,"translate"),p(4,"async"),o(),b(5,ge,7,5,"div",64)(6,Se,7,5,"div"),o()),a&2){let e=c(2).$implicit,i=c();n(2),s(" ",l(4,5,l(3,3,"transactions"))," "),n(3),x(i.getPayments(e.name).length>0?5:-1),n(),x(i.getReceivables(e.name).length>0?6:-1)}}function he(a,t){a&1&&(r(0,"span",73),m(1),p(2,"translate"),p(3,"async"),o()),a&2&&(n(),s(" ",l(3,3,l(2,1,"you_paid"))," "))}function Ee(a,t){if(a&1&&(r(0,"div",70)(1,"div",71)(2,"span",63),m(3),o(),r(4,"span",63),m(5),o()(),r(6,"div",72)(7,"span"),m(8),p(9,"translate"),p(10,"async"),o(),b(11,he,4,5,"span",73),o()()),a&2){let e=t.$implicit,i=c(4);n(3),u(e.expenseName),n(2),s("$",i.formatCurrency(e.contribution),""),n(3),M(" ",l(10,7,l(9,5,"total"))," $",i.formatCurrency(e.totalAmount)," "),n(3),x(e.isPayee?11:-1)}}function Be(a,t){if(a&1&&(r(0,"div")(1,"div",69),m(2),p(3,"translate"),p(4,"async"),o(),C(5,Ee,12,9,"div",70,S),o()),a&2){let e=c(2).$implicit;n(2),s(" ",l(4,3,l(3,1,"expense_breakdown"))," "),n(3),h(e.details)}}function we(a,t){if(a&1&&(r(0,"div",61)(1,"div",62)(2,"div",9),m(3),p(4,"translate"),p(5,"async"),r(6,"span",63),m(7),o()(),r(8,"div",9),m(9),p(10,"translate"),p(11,"async"),r(12,"span",63),m(13),o()()(),b(14,Ce,7,7,"div",64)(15,Be,7,5,"div"),o()),a&2){let e=c().$implicit,i=c();n(3),s(" ",l(5,8,l(4,6,"paid"))," "),n(4),s("$",i.formatCurrency(e.totalPaid),""),n(2),s(" ",l(11,12,l(10,10,"share"))," "),n(4),s("$",i.formatCurrency(e.totalOwed),""),n(),x(i.isInvolved(e.name)?14:-1),n(),x(e.details.length?15:-1)}}function Te(a,t){if(a&1){let e=k();r(0,"div",31)(1,"div",52),E("click",function(){let d=f(e).$implicit,_=c();return g(_.toggleMemberDetails(d.name))}),r(2,"div",53)(3,"div",54)(4,"div",55)(5,"span",56),B(),r(6,"svg",40),y(7,"circle",41)(8,"path",42),o()()(),w(),r(9,"h6",57)(10,"span",58),m(11),o()()(),r(12,"div",37)(13,"span",59),b(14,_e,4,6,"ng-container")(15,ye,4,6,"ng-container")(16,ve,4,5,"ng-container"),o(),r(17,"span",60),y(18,"i"),o()()(),b(19,we,16,14,"div",61),o()()}if(a&2){let e=t.$implicit,i=c();n(11),u(e.name),n(2),V(z(10,de,e.netBalance>0,e.netBalance<0)),n(),x(e.netBalance>0?14:-1),n(),x(e.netBalance<0?15:-1),n(),x(e.netBalance===0?16:-1),n(2),D("pi  ",i.isMemberExpanded(e.name)?"pi-angle-down":"pi-angle-right",""),n(),x(i.isMemberExpanded(e.name)?19:-1)}}var pe=class a{constructor(t,e){this.groupExpenseService=t;this.translate=e}members=[];expenses=[];memberSummaries=[];settlements=[];groupName="";totalExpensesAmout=0;expandedMembers={};op;calculationTypeOptions=[];calculationType="direct";ngOnInit(){this.loadData(),this.translate.getTranslations().subscribe(t=>{Object.keys(t).length>0&&(this.calculationTypeOptions=[{label:this.translate.getTranslation("direct_payment_logic"),value:"direct"},{label:this.translate.getTranslation("minified_transactions"),value:"minified"}])})}toggle(t){this.op.toggle(t)}loadData(){this.members=this.groupExpenseService.getMembers(),this.expenses=this.groupExpenseService.getExpenses(),this.groupName=this.groupExpenseService.getGroupDetails().name,this.calculateSummary(),this.calculateSettlements(this.calculationType),this.calculateTotalAmount(),this.members.forEach(t=>{this.expandedMembers[t.name]=!1})}calculateTotalAmount(){this.expenses.forEach(t=>{this.totalExpensesAmout+=t.amount})}CalctypeChange(){this.calculateSettlements(this.calculationType)}calculateSummary(){let t=this.groupExpenseService.getDetailedBreakdown();this.memberSummaries=this.members.map(e=>{let i=t[e.name];return{name:e.name,totalOwed:i.owed,totalPaid:i.paid,netBalance:i.net,details:i.details.map(d=>({expenseName:d.expenseName,paidBy:d.paidBy,totalAmount:d.totalAmount,contribution:d.shareAmount,isPayee:d.isPayee}))}})}calculateSettlements(t){this.calculationType==="direct"?this.settlements=this.groupExpenseService.calculateDirectSettlements():this.calculationType==="minified"&&(this.settlements=this.groupExpenseService.calculateMinimizedSettlements())}toggleMemberDetails(t){this.expandedMembers[t]=!this.expandedMembers[t]}isMemberExpanded(t){return this.expandedMembers[t]}formatCurrency(t){return t.toFixed(2)}getBalanceColorClass(t){return t>0?"positive-balance":t<0?"negative-balance":""}isInvolved(t){return this.settlements.some(e=>e.from===t||e.to===t)}getPayments(t){return this.settlements.filter(e=>e.from===t)}getReceivables(t){return this.settlements.filter(e=>e.to===t)}getTotalPayments(t){return this.getPayments(t).reduce((e,i)=>e+i.amount,0)}getTotalReceivables(t){return this.getReceivables(t).reduce((e,i)=>e+i.amount,0)}generateSummaryText(){let t=`Expense Summary

`,e=this.expenses.reduce((i,d)=>i+d.amount,0);return t+=`Total Expenses: $${e.toFixed(2)}

`,t+=`Settlements:
`,this.settlements.length===0?t+=`Everyone is settled up!
`:this.settlements.forEach(i=>{t+=`${i.from} pays ${i.to}: $${i.amount.toFixed(2)}
`}),t+=`
Individual Summaries:
`,this.memberSummaries.forEach(i=>{t+=`${i.name}: `,i.netBalance>0?t+=`gets back $${i.netBalance.toFixed(2)}`:i.netBalance<0?t+=`owes $${Math.abs(i.netBalance).toFixed(2)}`:t+="all settled",t+=` (paid $${i.totalPaid.toFixed(2)}, share $${i.totalOwed.toFixed(2)})
`}),t}shareSummary(){let t=this.generateSummaryText();navigator.clipboard.writeText(t).then(()=>{alert("Summary copied to clipboard!")}).catch(e=>{console.error("Could not copy text: ",e),alert("Failed to copy summary. Please try again.")})}static \u0275fac=function(e){return new(e||a)(F(ae),F(ie))};static \u0275cmp=j({type:a,selectors:[["app-expense-summery"]],viewQuery:function(e,i){if(e&1&&A(le,5),e&2){let d;G(d=O())&&(i.op=d.first)}},decls:60,vars:37,consts:[["op",""],[1,"md:py-2","py-1","md:min-h-screen"],[1,"justify-center","py-3","w-full","h-full"],[1,"card","border","shadow-sm","rounded-lg","lg:p-5","p-4","w-full"],[1,"flex","justify-between","items-end"],[1,"flex","items-center","gap-2","mb-2","md:mb-5","mt-2"],[1,"p-2","w-10","h-10","rounded-full","bg-primary-100","dark:bg-primary-300/20","text-primary","flex","justify-center","items-center"],[1,"pi","pi-users","text-base"],[1,"text-lg","lg:text-xl","font-bold"],[1,""],[1,"block","text-muted-color","text-end","text-sm","mb-1"],[1,"text-lg","font-bold","text-primary"],[1,"flex","justify-between","items-end","mb-4","md:mb-0","mt-3"],[1,"px-1"],[1,"text-lg","mt-2","sm:mb-1","font-semibold"],[1,"text-muted-color","text-sm","hidden","sm:block"],[1,"hidden","md:block"],["size","small","optionLabel","label","optionValue","value","aria-labelledby","basic",3,"onChange","ngModelChange","options","ngModel"],[1,"block","md:hidden"],[1,"text-primary-400","flex","items-center","p-1","rounded-md",3,"click"],[1,"pi","pi-cog"],[1,"pi","pi-angle-down","text-xs"],[1,"flex","flex-col","gap-2"],[1,"list-none","p-0","m-0","flex","flex-col"],[1,"flex","items-center","px-2","py-1","hover:bg-emphasis","cursor-pointer","rounded-border",3,"class"],[1,"mt-2","mb-4","lg:mt-5","border","rounded-lg"],[1,"p-3","my-3","rounded","text-center"],[1,"px-2","py-3","md:p-3","border-b","settlement-item","flex","items-center","justify-between","gap-3","last:border-b-0"],[1,"mt-3","lg:mt-5"],[1,"text-base","md:text-lg","mt-3","mb-1","p-1","font-semibold"],[1,"mt-3","border","rounded-lg"],[1,"border-b","p-1","md:py-2","last:border-b-0"],[1,"flex","justify-between","gap-2","mt-3","md:mt-4"],["type","button",1,"bg-emphasis","rounded-full","w-full","lg:w-1/6","py-2","px-5","flex","items-center","justify-center",3,"routerLink"],[1,"bg-primary","text-primary-contrast","rounded-full","w-full","lg:w-1/6","py-2","px-4","flex","items-center","justify-center",3,"click"],[1,"flex","items-center","px-2","py-1","hover:bg-emphasis","cursor-pointer","rounded-border",3,"click"],[1,"text-sm"],[1,"flex","items-center"],[1,"md:me-3","me-2","grid","place-items-center"],[1,"avatar","bg-red-100","dark:bg-red-400/10","text-red-400","dark:text-400","p-1.5","md:p-2.5","relative","rounded-full"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24"],["cx","12","cy","6","r","4","fill","currentColor"],["fill","currentColor","d","M20 17.5c0 2.485 0 4.5-8 4.5s-8-2.015-8-4.5S7.582 13 12 13s8 2.015 8 4.5"],[1,"font-medium","block","text-sm","md:text-base"],[1,"text-xs","text-muted-color","hidden","md:block"],[1,"font-bold","text-sm","md:text-base"],[1,"arrow-icon"],["xmlns","http://www.w3.org/2000/svg","width","28","height","14","viewBox","0 0 16 16",1,"text-muted-color"],["fill","currentColor","fill-rule","evenodd","d","M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"],[1,"text-end"],[1,"ms-2","md:ms-3","grid","place-items-center"],[1,"avatar","bg-green-100","dark:bg-green-300/10","text-green-400","p-1.5","md:p-2.5","relative","rounded-full"],["role","button",1,"w-full","rounded-md","p-2","md:p-3","transition-all",3,"click"],[1,"flex","justify-between","w-full"],[1,"flex","gap-1","items-center"],[1,"me-1","md:me-2","grid","place-items-center"],[1,"avatar","bg-primary-100","dark:bg-primary-contrast","text-primary","p-2","5","relative","rounded-full"],[1,"text-sm","md:text-base"],[1,"font-semibold"],[1,"font-medium","text-xs","sm:text-sm","text"],[1,"ms-1","text-slate-300","text-sm","collapse-icon"],[1,"mt-3","p-2"],[1,"flex","justify-between","text-sm","mb-2","pb-2","border-b","border-slate-100"],[1,"font-medium"],[1,"mb-3"],[1,"text-sm","font-medium","mb-3"],[1,"text-xs","mb-2"],[1,"text-sm","py-1","px-2","mb-2","bg-emphasis","border-l-2","border-red-300","rounded"],[1,"text-sm","py-1","px-2","mb-1","bg-emphasis","border-l-2","border-green-300","rounded"],[1,"text-sm","font-medium","mb-2"],[1,"text-sm","bg-emphasis","p-2","rounded","mb-1"],[1,"flex","justify-between"],[1,"text-xs","mt-2","flex","justify-between"],[1,"text-blue-600","text-xs","font-medium"]],template:function(e,i){if(e&1){let d=k();r(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"span",6),y(6,"i",7),o(),r(7,"h1",8),m(8),o()(),r(9,"div",9)(10,"span",10),m(11),p(12,"translate"),p(13,"async"),o(),r(14,"p",11),m(15),o()()(),r(16,"div",12)(17,"div",13)(18,"h5",14),m(19),p(20,"translate"),p(21,"async"),o(),r(22,"p",15),m(23),p(24,"translate"),p(25,"async"),o()(),r(26,"div",16)(27,"p-selectbutton",17),E("onChange",function(){return f(d),g(i.CalctypeChange())}),H("ngModelChange",function(v){return f(d),N(i.calculationType,v)||(i.calculationType=v),g(v)}),o()(),r(28,"div",18)(29,"span",19),E("click",function(v){return f(d),g(i.toggle(v))}),y(30,"i",20)(31,"i",21),o(),r(32,"p-popover",null,0)(34,"div",22)(35,"div")(36,"ul",23),C(37,ce,6,9,"li",24,S),o()()()()()(),r(39,"div",25),b(40,ue,4,5,"div",26),C(41,xe,34,16,"div",27,S),o(),r(43,"div",28)(44,"h5",29),m(45),p(46,"translate"),p(47,"async"),o(),r(48,"div",30),C(49,Te,20,13,"div",31,S),o()(),r(51,"div",32)(52,"button",33),m(53),p(54,"translate"),p(55,"async"),o(),r(56,"button",34),E("click",function(){return f(d),g(i.shareSummary())}),m(57),p(58,"translate"),p(59,"async"),o()()()()()}e&2&&(n(8),u(i.groupName),n(3),u(l(13,14,l(12,12,"total_amount"))),n(4),s(" $ ",i.totalExpensesAmout," "),n(4),s(" ",l(21,18,l(20,16,"settle_up"))," "),n(4),s(" ",l(25,22,l(24,20,"settle_up_description"))," "),n(4),P("options",i.calculationTypeOptions),L("ngModel",i.calculationType),n(10),h(i.calculationTypeOptions),n(3),x(i.settlements.length===0?40:-1),n(),h(i.settlements),n(4),s(" ",l(47,26,l(46,24,"summary_per_member"))," "),n(4),h(i.memberSummaries),n(3),P("routerLink",Q(36,me)),n(),s(" ",l(55,30,l(54,28,"back"))," "),n(4),s(" ",l(59,34,l(58,32,"share_summary"))," "))},dependencies:[X,U,q,ne,oe,re,te,ee,Y,Z,K,J],encapsulation:2})};export{pe as ExpenseSummeryComponent};
