import{b as J,c as h,d as K,e as Q,f as W,g as C,i as X,j as Y,k as Z,l as ee,m as te,n as ie,o as ne,p as re,q as pe,s as ae}from"./chunk-SK2G4LIT.js";import{a as le}from"./chunk-52JZBG57.js";import{$ as k,Ea as P,Fa as F,G as i,Ia as n,Ja as r,K as g,L as q,Q as f,U as _,Y as B,Za as $,_ as x,aa as N,ba as T,ca as a,da as o,ea as E,fb as O,hb as U,ia as V,ib as H,ka as G,kb as z,la as b,mb as oe,oa as R,pa as L,r as S,s as I,t as A,u as M,wa as m,xa as y,ya as c,za as D}from"./chunk-5JI43ALG.js";var j=e=>({"border-red-500":e}),de=()=>["/group-dashboard"];function me(e,t){e&1&&E(0,"div",2)}function ce(e,t){e&1&&(a(0,"h1",24),m(1),n(2,"translate"),n(3,"async"),o(),a(4,"p",25),m(5),n(6,"translate"),n(7,"async"),o()),e&2&&(i(),c(" ",r(3,4,r(2,2,"add_expense")),""),i(4),y(r(7,8,r(6,6,"add_expense_desc"))))}function ue(e,t){e&1&&(a(0,"h1",4),m(1),n(2,"translate"),n(3,"async"),n(4,"translate"),n(5,"async"),o()),e&2&&(i(),D("",r(3,4,r(2,2,"edit"))," ",r(5,8,r(4,6,"expenses")),""))}function xe(e,t){e&1&&(a(0,"small",11),m(1),n(2,"translate"),n(3,"async"),o()),e&2&&(i(),y(r(3,3,r(2,1,"this_field_required"))))}function fe(e,t){e&1&&(a(0,"small",11),m(1),n(2,"translate"),n(3,"async"),o()),e&2&&(i(),y(r(3,3,r(2,1,"this_field_required"))))}function he(e,t){if(e&1&&(a(0,"option",15),m(1),o()),e&2){let p=t.$implicit;_("value",p.name),i(),c(" ",p.name," ")}}function ve(e,t){e&1&&(a(0,"small",11),m(1),n(2,"translate"),n(3,"async"),o()),e&2&&(i(),y(r(3,3,r(2,1,"this_field_required"))))}function _e(e,t){if(e&1){let p=V();a(0,"div",20)(1,"label",26)(2,"div",27)(3,"input",28),G("change",function(d){let u=S(p).$implicit,v=b(2);return I(v.onCheckboxChange(u.name,d))}),o(),a(4,"span",29),A(),a(5,"svg",30),E(6,"path",31),o()()(),M(),a(7,"span",32),m(8),o()()()}if(e&2){let p=t.$implicit,l=t.$index,d=b(2);i(),L("for","member-checklist-",l,""),i(2),L("id","member-checklist-",l,""),_("checked",d.expenseForm.value.splitBetween.includes(p.name)),i(5),c(" ",p.name," ")}}function Ee(e,t){e&1&&(a(0,"span"),m(1),n(2,"translate"),n(3,"async"),o()),e&2&&(i(),c(" ",r(3,3,r(2,1,"add_expense"))," "))}function ge(e,t){e&1&&(a(0,"span"),m(1),n(2,"translate"),n(3,"async"),o()),e&2&&(i(),c(" ",r(3,3,r(2,1,"edit"))," "))}function be(e,t){if(e&1){let p=V();a(0,"div",3),f(1,ce,8,10)(2,ue,6,10,"h1",4),a(3,"form",5),G("ngSubmit",function(){S(p);let d=b();return I(d.addExpense())}),a(4,"div",6)(5,"div",7)(6,"div",8)(7,"label",9),m(8),n(9,"translate"),n(10,"async"),o(),E(11,"input",10),n(12,"translate"),n(13,"async"),f(14,xe,4,5,"small",11),o(),a(15,"div",8)(16,"label",9),m(17),n(18,"translate"),n(19,"async"),o(),E(20,"input",12),n(21,"translate"),n(22,"async"),f(23,fe,4,5,"small",11),o(),a(24,"div",8)(25,"label",9),m(26),n(27,"translate"),n(28,"async"),o(),a(29,"div",13)(30,"select",14),N(31,he,2,2,"option",15,k),o(),A(),a(33,"svg",16),E(34,"path",17),o()(),f(35,ve,4,5,"small",11),o(),M(),a(36,"div",8)(37,"div",18)(38,"label",9),m(39),n(40,"translate"),n(41,"async"),o(),a(42,"nav",19),N(43,_e,9,6,"div",20,k),o()()()()(),a(45,"div",21)(46,"button",22),m(47),n(48,"translate"),n(49,"async"),o(),a(50,"button",23),f(51,Ee,4,5,"span")(52,ge,4,5,"span"),o()()()()}if(e&2){let p,l,d,u,v,w,s=b();i(),x(s.currentId?2:1),i(2),_("formGroup",s.expenseForm),i(5),c(" ",r(10,23,r(9,21,"expense_name"))," "),i(3),B(F(49,j,((p=s.expenseForm.get("expenseName"))==null?null:p.invalid)&&((p=s.expenseForm.get("expenseName"))==null?null:p.touched))),R("placeholder",r(13,27,r(12,25,"expense_name_placeholder"))),i(3),x((l=s.expenseForm.get("expenseName"))!=null&&l.invalid&&((l=s.expenseForm.get("expenseName"))!=null&&l.touched)?14:-1),i(3),c(" ",r(19,31,r(18,29,"expense_amount"))," "),i(3),B(F(51,j,((d=s.expenseForm.get("amount"))==null?null:d.invalid)&&((d=s.expenseForm.get("amount"))==null?null:d.touched))),R("placeholder",r(22,35,r(21,33,"expense_amount_placeholder"))),i(3),x((u=s.expenseForm.get("amount"))!=null&&u.invalid&&((u=s.expenseForm.get("amount"))!=null&&u.touched)?23:-1),i(3),c(" ",r(28,39,r(27,37,"who_payed"))," "),i(4),B(F(53,j,((v=s.expenseForm.get("paidBy"))==null?null:v.invalid)&&((v=s.expenseForm.get("paidBy"))==null?null:v.touched))),i(),T(s.groupMembers),i(4),x((w=s.expenseForm.get("paidBy"))!=null&&w.invalid&&((w=s.expenseForm.get("paidBy"))!=null&&w.touched)?35:-1),i(4),c(" ",r(41,43,r(40,41,"split_between"))," "),i(4),T(s.groupMembers),i(3),_("routerLink",P(55,de)),i(),c(" ",r(49,47,r(48,45,"cancel"))," "),i(3),_("disabled",s.expenseForm.invalid),i(),x(s.currentId?52:51)}}var se=class e{constructor(t,p,l,d){this.fb=t;this.groupExpenseService=p;this.router=l;this.route=d}expenseForm;groupMembers=[];expenses=[];currentId;currentExpense;lastExpenseId=0;ngOnInit(){if(this.groupMembers=this.groupExpenseService.getMembers(),this.expenses=this.groupExpenseService.getExpenses(),this.lastExpenseId=this.calculateLastExpenseId(),this.groupMembers.length&&this.expenseForm&&this.expenseForm?.patchValue({paidBy:this.groupMembers[0].name}),this.currentId=this.captureIdFromURL(),this.currentId){let t=this.groupExpenseService.getSingleExpense(this.currentId);t?(this.currentExpense=t,console.log(this.currentExpense),this.generateExpenseForm(this.currentExpense)):this.generateExpenseForm(null)}else this.generateExpenseForm(null)}captureIdFromURL(){return Number(this.route.snapshot.paramMap.get("id"))}generateExpenseForm(t){this.expenseForm=new W({expenseName:new C(t?this.currentExpense.expenseName:"",[h.required,h.pattern(/[\S]/g)]),amount:new C(t?this.currentExpense.amount:null,[h.required,h.min(1)]),paidBy:new C(t?this.currentExpense.paidBy:"",h.required),splitBetween:new re(t?this.currentExpense.splitBetween.map(p=>new C(p)):[],h.required)})}calculateLastExpenseId(){return this.expenses.length?Math.max(...this.expenses.map(t=>t.id)):0}generateUniqueId(){return this.lastExpenseId++,this.lastExpenseId}get splitBetween(){return this.expenseForm.get("splitBetween")}onCheckboxChange(t,p){let l=this.expenseForm.get("splitBetween");if(p.target.checked)l.controls.some(d=>d.value===t)||l.push(this.fb.control(t));else{let d=l.controls.findIndex(u=>u.value===t);d!==-1&&l.removeAt(d)}}addExpense(){if(this.expenseForm.invalid){alert("Please fill in all fields and select at least one member for splitting.");return}let t=this.expenseForm.value,p={id:this.currentExpense?this.currentExpense.id:this.generateUniqueId(),expenseName:t.expenseName,amount:t.amount,paidBy:t.paidBy,splitBetween:t.splitBetween};this.currentExpense?this.groupExpenseService.editExpense(this.currentId,p):this.groupExpenseService.addExpense(p),this.expenses=this.groupExpenseService.getExpenses(),this.expenseForm.reset(),this.groupMembers.length&&this.expenseForm&&this.expenseForm?.patchValue({paidBy:this.groupMembers[0].name}),this.router.navigate(["/group-dashboard"])}static \u0275fac=function(p){return new(p||e)(g(pe),g(le),g(U),g(O))};static \u0275cmp=q({type:e,selectors:[["app-add-edit-expense"]],decls:4,vars:2,consts:[[1,"py-3","min-h-screen"],[1,"flex","justify-center","py-3","w-full","h-full"],[1,"loader","p-4","my-5","m-2"],[1,"card","border","shadow-sm","rounded-lg","lg:p-5","p-4","w-full"],[1,"text-base","lg:text-lg","mb-2","md:mb-3","mt-2","font-bold"],["action","",3,"ngSubmit","formGroup"],[1,"mt-2"],[1,"w-full"],[1,"py-2","my-2"],[1,"block","mb-3","font-bold","text-sm","px-1"],["formControlName","expenseName",1,"w-full","text-sm","border","rounded-lg","px-3","py-2","transition","duration-300","ease","focus:outline-none","focus:border-slate-400","hover:border-slate-300","focus:shadow",3,"placeholder"],[1,"text-red-500","mt-2","block","px-1"],["formControlName","amount","type","number",1,"w-full","text-sm","border","rounded-lg","px-3","py-2","transition","duration-300","ease","focus:outline-none","focus:border-slate-400","hover:border-slate-300","focus:shadow",3,"placeholder"],[1,"relative"],["formControlName","paidBy",1,"w-full","text-sm","border","rounded-lg","pl-3","pr-8","py-2","transition","duration-300","ease","focus:outline-none","hover:border-slate-300","focus:shadow-md","appearance-none","cursor-pointer"],[3,"value"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.2","stroke","currentColor",1,"h-5","w-5","ml-1","absolute","top-2.5","right-2.5","text-slate-700"],["stroke-linecap","round","stroke-linejoin","round","d","M8.25 15 12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9"],[1,"relative","max-w-xl","flex","w-full","flex-col"],[1,"flex","flex-col","gap-1","rounded-xl","py-2"],[1,"flex","w-full","items-center","rounded-lg","p-0","transition-all"],[1,"flex","justify-between","border-t","gap-2","mt-3","pt-4"],["type","button",1,"bg-emphasis","text-neutral-600","rounded-full","w-full","lg:w-1/6","py-2","px-5","flex","items-center","justify-center",3,"routerLink"],["type","submit",1,"bg-primary","text-primary-contrast","rounded-full","w-full","lg:w-1/5","py-2","px-4","flex","items-center","justify-center","disabled:bg-primary-300",3,"disabled"],[1,"text-base","lg:text-lg","mb-1","md:mb-3","mt-2","font-bold"],[1,"text-muted-color","text-sm","mb-3"],[1,"flex","w-full","cursor-pointer","items-center","px-2","py-2",3,"for"],[1,"inline-flex","items-center","relative"],["type","checkbox",1,"peer","h-5","w-5","cursor-pointer","transition-all","appearance-none","rounded","hover:shadow-md","border","border-slate-300","checked:bg-primary","checked:border-primary",3,"change","id","checked"],[1,"absolute","text-primary-contrast","opacity-0","peer-checked:opacity-100","top-1/2","left-1/2","transform","-translate-x-1/2","-translate-y-1/2"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor","stroke","currentColor","stroke-width","1",1,"h-3.5","w-3.5"],["fill-rule","evenodd","d","M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule","evenodd"],[1,"cursor-pointer","ms-2","text-sm"]],template:function(p,l){p&1&&(a(0,"div",0)(1,"div",1),f(2,me,1,0,"div",2)(3,be,53,56,"div",3),o()()),p&2&&(i(2),x(l.currentId&&!l.expenses||!l.expenseForm?2:-1),i(),x(l.expenseForm?3:-1))},dependencies:[z,H,$,oe,ae,X,ie,ne,J,Y,te,K,Q,Z,ee],encapsulation:2})};export{se as AddEditExpenseComponent};
